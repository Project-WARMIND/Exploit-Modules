import random
import string
from impacket import smb


class ExploitFailed(Exception): pass


class CleanUpFailure(Exception): pass


class OperatingSystemNotSupported(ExploitFailed): pass


class SMBTransaction2SecondaryParametersFixed(smb.SMBCommand_Parameters):
    structure = (
        ('TotalParameterCount','<H=0'),
        ('TotalDataCount','<H'),
        ('ParameterCount','<H=0'),
        ('ParameterOffset','<H=0'),
        ('ParameterDisplacement','<H=0'),
        ('DataCount','<H'),
        ('DataOffset','<H'),
        ('DataDisplacement','<H=0'),
        ('FID','<H=0'),
)


def random_filename():
    retval = []
    length = 5
    for _ in range(length):
        retval.append(random.choice(string.ascii_letters))
    return "{}.txt".format(''.join(retval))