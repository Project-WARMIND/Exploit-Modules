import random
import string

from impacket import smb


class ExploitFailed(EnvironmentError):
    pass


class CleanUpFailure(IOError):
    pass


class OperatingSystemNotSupported(OSError):
    pass


class SMBTransaction2SecondaryParametersFixed(smb.SMBCommand_Parameters):
    structure = (
        ('TotalParameterCount', '<H=0'),
        ('TotalDataCount', '<H'),
        ('ParameterCount', '<H=0'),
        ('ParameterOffset', '<H=0'),
        ('ParameterDisplacement', '<H=0'),
        ('DataCount', '<H'),
        ('DataOffset', '<H'),
        ('DataDisplacement', '<H=0'),
        ('FID', '<H=0'),
    )


def random_filename(file_extension="txt"):
    retval = []
    length = 5
    for _ in range(length):
        retval.append(random.choice(string.ascii_letters))
    return "{}.{}".format(''.join(retval), file_extension)
