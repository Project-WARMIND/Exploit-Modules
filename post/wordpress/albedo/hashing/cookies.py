import hashlib
import random
import string

from passlib.hash import cisco_type7


def random_string(length=10, email=False):
    acceptable = string.ascii_letters
    retval = []
    for _ in range(length):
        retval.append(random.choice(acceptable))
    if not email:
        return ''.join(retval)
    else:
        ext = (".com", ".net", ".org")
        smtp = ("gmail", "yahoo", "protonmail")
        return "{}@{}.{}".format(
            ''.join(retval),
            random.choice(smtp),
            random.choice(ext)
        )


def create_random_cookie(waf=False, author=False, wp_syntax=False, simple=False, username=None):
    if waf:
        obj1 = hashlib.sha256()
        obj2 = hashlib.sha256()
        obj1.update(random_string())
        obj2.update(random_string())
        return "{}={}".format(
            obj1.hexdigest(), obj2.hexdigest()
        )
    elif simple:
        obj = hashlib.sha256()
        obj.update(random_string())
        return obj.hexdigest()
    elif author:
        obj = hashlib.md5()
        obj.update(random_string())
        return obj.hexdigest()
    elif wp_syntax:
        start_space = "{}|".format(username)
        second_space = "{}|".format(random.choice(xrange(1999999999)))
        third_space = "{}|".format(cisco_type7.encrypt(random_string()))
        final_space = create_random_cookie(simple=True)
        item = "{}{}{}{}".format(
            start_space, second_space, third_space, final_space
        )
        return item

